<!DOCTYPE html>
<html class="dark" lang="es">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Pantalla de Selección de Signos</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet"/>
<style>
    .material-symbols-outlined {
        font-variation-settings:
        'FILL' 0,
        'wght' 400,
        'GRAD' 0,
        'opsz' 24
    }
</style>
<script>
    tailwind.config = {
        darkMode: "class",
        theme: {
            extend: {
                colors: {
                    "primary": "#7f13ec",
                    "background-light": "#f7f6f8",
                    "background-dark": "#191022",
                },
                fontFamily: {
                    "display": ["Be Vietnam Pro", "sans-serif"]
                },
                borderRadius: {
                    "DEFAULT": "0.5rem",
                    "lg": "1rem",
                    "xl": "1.5rem",
                    "full": "9999px"
                },
            },
        },
    }
</script>
<style>
    body { min-height: max(884px, 100dvh); }
</style>
</head>
<body class="bg-background-light dark:bg-background-dark font-display">
<div class="relative flex h-screen w-full flex-col">
    <!-- Top App Bar -->
    <header class="flex shrink-0 items-center justify-between bg-background-light/80 p-4 pb-2 dark:bg-background-dark/80 backdrop-blur-sm sticky top-0 z-10">
        <div class="flex size-12 shrink-0 items-center"></div>
        <h1 class="flex-1 text-center text-lg font-bold tracking-tight text-slate-900 dark:text-white">Elige tu Signo</h1>
        <div class="flex w-12 items-center justify-end">
            <button class="flex h-12 cursor-pointer items-center justify-center rounded-xl bg-transparent text-slate-600 dark:text-slate-300">
                <span class="material-symbols-outlined text-2xl"></span>
            </button>
        </div>
    </header>

    <!-- Main Content Grid -->
    <main class="flex-1 overflow-y-auto p-4">
        <div id="signosContainer" class="grid grid-cols-2 gap-4 sm:grid-cols-3">
            <p class="col-span-full text-center text-slate-500 dark:text-slate-400">Cargando signos...</p>
        </div>
    </main>

    <!-- Bottom Navigation Bar -->
    <footer class="flex shrink-0 gap-2 border-t border-slate-200 bg-white/80 px-4 pb-3 pt-2 dark:border-slate-800 dark:bg-background-dark/80 backdrop-blur-sm sticky bottom-0 z-10">
        <a class="flex flex-1 flex-col items-center justify-end gap-1 text-slate-500 dark:text-slate-400" href="#">
            <div class="flex h-8 items-center justify-center">
                <span class="material-symbols-outlined">spark</span>
            </div>
            <p class="text-xs font-medium tracking-wide">Horóscopo</p>
        </a>
    </footer>
</div>

<script>

// Función para quitar acentos y convertir a minúsculas
function normalizarSigno(signo) {
    return signo
        .normalize("NFD")       // descompone acentos
        .replace(/[\u0300-\u036f]/g, "") // elimina acentos
        .toLowerCase();         // convierte a minúsculas
}

async function cargarSignos() {
    try {
        const response = await fetch("http://127.0.0.1:8000/api7/horoscopos/");
        if (!response.ok) throw new Error('Error al cargar API');
        const data = await response.json();

        const container = document.getElementById("signosContainer");
        container.innerHTML = ""; // Limpiar placeholder

        data.forEach(h => {
            const signoLower = h.signo.toLowerCase(); // Para URL
            const detalleURL = `detail.html?signo=${signoLower}`;

            // Normalizar solo para el icono
            const iconoNormalizado = normalizarSigno(h.signo);
            const iconoUrl = `icons/${iconoNormalizado}.png`;

            console.log(`Signo: ${h.signo}, URL detalle: ${detalleURL}, Icono: ${iconoUrl}`);

            const a = document.createElement("a");
            a.href = detalleURL;
            a.onclick = () => localStorage.setItem('signoSeleccionado', signoLower);
            a.className = "flex flex-col items-center gap-3 rounded-xl border border-slate-200 bg-white p-4 text-center transition-transform duration-200 hover:scale-105 dark:border-slate-800 dark:bg-slate-900/50";

            a.innerHTML = `
                <img src="${iconoUrl}" alt="${h.signo}" class="w-12 h-12"/>
                <div class="flex flex-col">
                    <h2 class="font-bold text-slate-900 dark:text-white">${h.signo}</h2>
                    <p class="text-sm text-slate-500 dark:text-slate-400">${h.rango_fecha}</p>
                </div>
            `;
            container.appendChild(a);
        });
    } catch (err) {
        console.error(err);
        container.innerHTML = `<p class="col-span-full text-center text-red-500">No se pudieron cargar los signos.</p>`;
    }
}



cargarSignos();
</script>
</body>
</html>
